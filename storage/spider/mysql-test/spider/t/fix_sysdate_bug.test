# fix bug for "create or replace table t1 (a int, b varchar(10) generated always as (sysdate()) virtual)"
--disable_warnings
--disable_query_log
--disable_result_log
--source test_init.inc
--enable_result_log
--enable_query_log

--echo
--echo drop and create databases
--connection master_1
--disable_warnings
DROP DATABASE IF EXISTS auto_test_local;
CREATE DATABASE auto_test_local;
USE auto_test_local;
if ($USE_GENERAL_LOG)
 {
    SET @old_log_output = @@global.log_output;
    SET GLOBAL log_output = 'TABLE,FILE';
 }
--enable_warnings


--disable_warnings
DROP TABLE IF EXISTS tbl_a;
--enable_warnings
--enable_query_log
--enable_result_log
create or replace table tbl_a (a int, b varchar(10) generated always as (sysdate()) virtual);
create or replace table tbl_a (a int, b varchar(10) generated always as (sysdate()) virtual);
show create table tbl_a;



  if ($USE_GENERAL_LOG)
  {
    --echo
    --echo select for master
    SELECT argument FROM mysql.general_log WHERE argument LIKE '%create %';
  }

--echo
--echo deinit
--disable_warnings
--connection master_1
DROP DATABASE IF EXISTS auto_test_local;
  if ($USE_GENERAL_LOG)
  {
    SET GLOBAL log_output = @old_log_output;
  }


--disable_query_log
--disable_result_log
--source test_deinit.inc
--enable_result_log
--enable_query_log
--enable_warnings
--echo
--echo end of test


