--source include/have_tcadmin.inc

CREATE TABLE t1 (a INT primary key) ENGINE=InnoDB;
CREATE TABLE t2 (b INT primary key) ENGINE=InnoDB;
CREATE TABLE t3 (c INT primary key) ENGINE=InnoDB;

--delimiter $$
CREATE TRIGGER tr BEFORE INSERT ON t3 FOR EACH ROW BEGIN SAVEPOINT sv; INSERT INTO t2 VALUES (0); END $$
--delimiter ;

DELETE FROM t1;

INSERT INTO t2 VALUES (2);
UPDATE t2 SET b = b+1;

INSERT INTO t1 VALUES (1);

INSERT INTO t3 VALUES (2);

DROP TABLE t1, t2, t3;
--error ER_TRG_DOES_NOT_EXIST
DROP TRIGGER tr;
